---
layout: post
title:  "数据科学中的数据泄露 Data Leakage"
date:   2019-07-26 14:24:01 +0800
categories: 数据分析
tag: 数据分析
---

* content
{:toc}


****

> **未经许可，严禁任何形式的转载！**

****

**参考**

- [再论数据科学竞赛中的 Data Leakage](https://zhuanlan.zhihu.com/p/24357137)

****

数据泄露（`Data Leakage`）通常是由于以下原因造成：

1. 在模型训练时，利用率验证集部分的数据或信息
2. 在当前使用了未来时刻的数据（时序数据）
3. 在训练数据的因子中，包含了与预测结果直接相关的信息

第二点较好理解，未来时刻的数据是要预测的值，显然不能包含进来。

而对于第一点，存在一个较为隐晦的可能性。比方说要对数据及进行 `z-score` 等操作，正确的做法应该是先对训练集进行标准化，然后用得到的 `mean` 和 `std` 对验证集进行标准化。而不应该先进行标准化，再进行数据集划分。之前做股票预测相关项目时，就没注意这一点，导致验证结果异常的好，但实际表现并不好。

至于第三点，一般认为这才是真正的数据泄露。其主要问题在于，将与预测结果直接相关的因素作为训练因子，而该因子与预测结果同为某些用于训练依据的因子的果。所以这将导致以结果预测结果！可以看下面的例子。

```md
在男性前列腺癌数据中，有个 feature 叫 PROSSUG，代表着这个患者是否接受过前列腺的手术，这个 feature 很难说是病人患前列腺癌的‘原因’（患心脏病的原因是接受过心脏手术？），而更像是一个标记，当然与病人是否患有前列腺癌极度相关。依靠着这样的 feature 训练出来的模型，肯定能够得到很好的预测结果，但对实际了解男性前列腺癌的成因，没有一点帮助。
```